<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2306px" preserveAspectRatio="none" style="width:1157px;height:2306px;" version="1.1" viewBox="0 0 1157 2306" width="1157px" zoomAndPan="magnify"><defs/><g><!--MD5=[858307e347215d8034d295bce1f15f07]
class SelectFileControl--><rect fill="#FEFECE" height="89.5078" id="SelectFileControl" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="843.5" y="2206"/><ellipse cx="858.5" cy="2222" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M857,2223 L857,2225 L861,2225 L861,2224 L861,2223.5156 L861.625,2223 L862,2223 L862.375,2223 L863,2223.5156 L863,2224 L863,2227 L855,2227 L854.5156,2227 L854,2226.375 L854,2226 L854,2225.625 L854.5156,2225 L855,2225 L855,2225 L855,2219 L855,2219 L854.5156,2219 L854,2218.375 L854,2218 L854,2217.625 L854.5156,2217 L855,2217 L863,2217 L863,2220 L863,2220.4844 L862.375,2221 L862,2221 L861.625,2221 L861,2220.4844 L861,2220 L861,2219 L857,2219 L857,2221 L858,2221 L858,2220.5156 L858,2220.5156 L858.625,2220 L859,2220 L859.375,2220 L860,2220.5156 L860,2221 L860,2223 L860,2223.4844 L859.375,2224 L859.375,2224 L859,2224 L858.625,2224 L858,2223.4844 L858,2223.4844 L858,2223 L857,2223 Z "/><ellipse cx="877.5" cy="2221.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="883.5" y="2226.9102">SelectFileControl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="844.5" x2="979.5" y1="2238" y2="2238"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="849.5" y="2253.4189">FIRST_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="849.5" y="2267.2549">NEXT_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="849.5" y="2281.0908">CURRENT_DF</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="844.5" x2="979.5" y1="2287.5078" y2="2287.5078"/><!--MD5=[ee0d3336d8d2c9dd88a5ad188defe636]
class ChannelControl--><rect fill="#FEFECE" height="75.6719" id="ChannelControl" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="1016" y="2213"/><ellipse cx="1031" cy="2229" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M1029.5,2230 L1029.5,2232 L1033.5,2232 L1033.5,2231 L1033.5,2230.5156 L1034.125,2230 L1034.5,2230 L1034.875,2230 L1035.5,2230.5156 L1035.5,2231 L1035.5,2234 L1027.5,2234 L1027.0156,2234 L1026.5,2233.375 L1026.5,2233 L1026.5,2232.625 L1027.0156,2232 L1027.5,2232 L1027.5,2232 L1027.5,2226 L1027.5,2226 L1027.0156,2226 L1026.5,2225.375 L1026.5,2225 L1026.5,2224.625 L1027.0156,2224 L1027.5,2224 L1035.5,2224 L1035.5,2227 L1035.5,2227.4844 L1034.875,2228 L1034.5,2228 L1034.125,2228 L1033.5,2227.4844 L1033.5,2227 L1033.5,2226 L1029.5,2226 L1029.5,2228 L1030.5,2228 L1030.5,2227.5156 L1030.5,2227.5156 L1031.125,2227 L1031.5,2227 L1031.875,2227 L1032.5,2227.5156 L1032.5,2228 L1032.5,2230 L1032.5,2230.4844 L1031.875,2231 L1031.875,2231 L1031.5,2231 L1031.125,2231 L1030.5,2230.4844 L1030.5,2230.4844 L1030.5,2230 L1029.5,2230 Z "/><ellipse cx="1050" cy="2228.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="1056" y="2233.9102">ChannelControl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1017" x2="1145" y1="2245" y2="2245"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="1022" y="2260.4189">KEEP_OPEN</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="1022" y="2274.2549">CLOSE_AFTER</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1017" x2="1145" y1="2280.6719" y2="2280.6719"/><!--MD5=[e8e21ba3995782366e9aa9ad2c6b2d5f]
class PoResource--><rect fill="#FEFECE" height="75.6719" id="PoResource" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="322.5" y="820.5"/><ellipse cx="344.25" cy="836.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M346.25,833 Q346.4531,832.5 346.6875,832.25 Q346.9219,832 347.1875,832 Q347.6563,832 347.9531,832.2813 Q348.25,832.5625 348.25,833.2188 L348.25,834.7813 Q348.25,835.4375 347.9688,835.7188 Q347.6875,836 347.25,836 Q346.8594,836 346.6094,835.8281 Q346.3594,835.6563 346.25,835.2031 Q346.2031,834.8906 346.0313,834.7188 Q345.7188,834.3906 345.1563,834.2031 Q344.5938,834 344.0313,834 Q343.3281,834 342.7344,834.2813 Q342.1563,834.5625 341.7031,835.1875 Q341.25,835.8125 341.25,836.6719 L341.25,837.5938 Q341.25,838.625 342.0938,839.3125 Q342.9375,840 344.4375,840 Q345.3281,840 345.9531,839.7969 Q346.3125,839.6875 346.7188,839.3281 Q346.9844,839.125 347.125,839.0625 Q347.2656,839 347.4375,839 Q347.7656,839 348,839.2656 Q348.25,839.5156 348.25,839.875 Q348.25,840.2188 347.9063,840.625 Q347.4063,841.2188 346.6094,841.5469 Q345.5625,842 344.2813,842 Q342.7813,842 341.5781,841.4063 Q340.6094,840.9375 339.9219,839.9219 Q339.25,838.9063 339.25,837.7031 L339.25,836.6094 Q339.25,835.3594 339.8438,834.2656 Q340.4531,833.1719 341.5,832.5938 Q342.5625,832 343.75,832 Q344.4688,832 345.0938,832.25 Q345.7188,832.5 346.25,833 Z "/><ellipse cx="364.75" cy="836" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="370.75" y="841.4102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="62" x="454.5" y="817.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="60" x="455.5" y="830.957">CalypsoPo</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="323.5" x2="512.5" y1="852.5" y2="852.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="323.5" x2="512.5" y1="860.5" y2="860.5"/><ellipse cx="333.5" cy="871.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="342.5" y="875.9189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="406.5" y="875.9189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="504.5" y="875.9189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="342.5" y="889.7549">CalypsoPo po);</text><!--MD5=[f25ff1fa8fa59bbc0543eaadeb7d653a]
class CalypsoSam--><rect fill="#FEFECE" height="158.6875" id="CalypsoSam" style="stroke: #A80036; stroke-width: 1.5;" width="251" x="813.5" y="779"/><ellipse cx="880.25" cy="795" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M882.25,791.5 Q882.4531,791 882.6875,790.75 Q882.9219,790.5 883.1875,790.5 Q883.6563,790.5 883.9531,790.7813 Q884.25,791.0625 884.25,791.7188 L884.25,793.2813 Q884.25,793.9375 883.9688,794.2188 Q883.6875,794.5 883.25,794.5 Q882.8594,794.5 882.6094,794.3281 Q882.3594,794.1563 882.25,793.7031 Q882.2031,793.3906 882.0313,793.2188 Q881.7188,792.8906 881.1563,792.7031 Q880.5938,792.5 880.0313,792.5 Q879.3281,792.5 878.7344,792.7813 Q878.1563,793.0625 877.7031,793.6875 Q877.25,794.3125 877.25,795.1719 L877.25,796.0938 Q877.25,797.125 878.0938,797.8125 Q878.9375,798.5 880.4375,798.5 Q881.3281,798.5 881.9531,798.2969 Q882.3125,798.1875 882.7188,797.8281 Q882.9844,797.625 883.125,797.5625 Q883.2656,797.5 883.4375,797.5 Q883.7656,797.5 884,797.7656 Q884.25,798.0156 884.25,798.375 Q884.25,798.7188 883.9063,799.125 Q883.4063,799.7188 882.6094,800.0469 Q881.5625,800.5 880.2813,800.5 Q878.7813,800.5 877.5781,799.9063 Q876.6094,799.4375 875.9219,798.4219 Q875.25,797.4063 875.25,796.2031 L875.25,795.1094 Q875.25,793.8594 875.8438,792.7656 Q876.4531,791.6719 877.5,791.0938 Q878.5625,790.5 879.75,790.5 Q880.4688,790.5 881.0938,790.75 Q881.7188,791 882.25,791.5 Z "/><ellipse cx="905.75" cy="794.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="911.75" y="799.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="938.75" y="799.9102">CalypsoSam</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="814.5" x2="1063.5" y1="811" y2="811"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="814.5" x2="1063.5" y1="819" y2="819"/><polygon fill="#4177AF" points="824.5,826,820.5,832,828.5,832" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="833.5" y="834.4189">CalypsoSam(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="897.5" y="834.4189">SeResponse selectionResponse</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="4" x="1054.5" y="834.4189">)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="836.5" y="848.2549"/><ellipse cx="824.5" cy="857.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="833.5" y="862.0908">SamRevision getSamRevision()</text><ellipse cx="824.5" cy="871.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="833.5" y="875.9268">byte[] getSerialNumber()</text><ellipse cx="824.5" cy="885.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="833.5" y="889.7627">byte getPlatform()</text><ellipse cx="824.5" cy="899.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="833.5" y="903.5986">byte getApplicationType()</text><ellipse cx="824.5" cy="913.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="833.5" y="917.4346">byte getApplicationSubType()</text><ellipse cx="824.5" cy="926.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="833.5" y="931.2705">byte getSoftwareIssuer()</text><!--MD5=[8eb5cec01ad571a9feeff1db4f73a667]
class PoTransaction--><rect fill="#FEFECE" height="712.125" id="PoTransaction" style="stroke: #A80036; stroke-width: 1.5;" width="764" x="322" y="998"/><ellipse cx="654.25" cy="1014" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M656.25,1010.5 Q656.4531,1010 656.6875,1009.75 Q656.9219,1009.5 657.1875,1009.5 Q657.6563,1009.5 657.9531,1009.7813 Q658.25,1010.0625 658.25,1010.7188 L658.25,1012.2813 Q658.25,1012.9375 657.9688,1013.2188 Q657.6875,1013.5 657.25,1013.5 Q656.8594,1013.5 656.6094,1013.3281 Q656.3594,1013.1563 656.25,1012.7031 Q656.2031,1012.3906 656.0313,1012.2188 Q655.7188,1011.8906 655.1563,1011.7031 Q654.5938,1011.5 654.0313,1011.5 Q653.3281,1011.5 652.7344,1011.7813 Q652.1563,1012.0625 651.7031,1012.6875 Q651.25,1013.3125 651.25,1014.1719 L651.25,1015.0938 Q651.25,1016.125 652.0938,1016.8125 Q652.9375,1017.5 654.4375,1017.5 Q655.3281,1017.5 655.9531,1017.2969 Q656.3125,1017.1875 656.7188,1016.8281 Q656.9844,1016.625 657.125,1016.5625 Q657.2656,1016.5 657.4375,1016.5 Q657.7656,1016.5 658,1016.7656 Q658.25,1017.0156 658.25,1017.375 Q658.25,1017.7188 657.9063,1018.125 Q657.4063,1018.7188 656.6094,1019.0469 Q655.5625,1019.5 654.2813,1019.5 Q652.7813,1019.5 651.5781,1018.9063 Q650.6094,1018.4375 649.9219,1017.4219 Q649.25,1016.4063 649.25,1015.2031 L649.25,1014.1094 Q649.25,1012.8594 649.8438,1011.7656 Q650.4531,1010.6719 651.5,1010.0938 Q652.5625,1009.5 653.75,1009.5 Q654.4688,1009.5 655.0938,1009.75 Q655.7188,1010 656.25,1010.5 Z "/><ellipse cx="679.75" cy="1013.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="685.75" y="1018.9102">PoTransaction</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="323" x2="1085" y1="1030" y2="1030"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="323" x2="1085" y1="1038" y2="1038"/><ellipse cx="333" cy="1049" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="388" x="342" y="1053.4189">PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1067.2549"/><ellipse cx="333" cy="1076.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1081.0908">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="227" x="368" y="1081.0908">processPoCommands(ChannelControl channel)</text><ellipse cx="333" cy="1090.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1094.9268">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="368" y="1094.9268">processOpening(AccessLevel level)</text><ellipse cx="333" cy="1104.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1108.7627">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="368" y="1108.7627">processPoCommandsInSession()</text><ellipse cx="333" cy="1118.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1122.5986">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="368" y="1122.5986">processClosing(ChannelControl channel)</text><ellipse cx="333" cy="1132.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1136.4346">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="368" y="1136.4346">processCancel(ChannelControl channel)</text><ellipse cx="333" cy="1145.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1150.2705">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="398" x="368" y="1150.2705">prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)</text><ellipse cx="333" cy="1159.6875" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1164.1064">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="218" x="368" y="1164.1064">SessionSecureData getSessionSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1177.9424"/><ellipse cx="333" cy="1187.3594" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1191.7783">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="368" y="1191.7783">prepareCheckPinStatus()</text><ellipse cx="333" cy="1201.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1205.6143">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="368" y="1205.6143">prepareVerifyPin(String pin)</text><ellipse cx="333" cy="1215.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1219.4502">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="368" y="1219.4502">prepareVerifyPin(byte[] pin)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1233.2861"/><ellipse cx="333" cy="1242.7031" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1247.1221">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="338" x="368" y="1247.1221">prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)</text><ellipse cx="333" cy="1256.5391" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1260.958">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="278" x="368" y="1260.958">prepareSvReload(int amount, int date, int time, String free)</text><ellipse cx="333" cy="1270.375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1274.7939">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="368" y="1274.7939">prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)</text><ellipse cx="333" cy="1284.2109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1288.6299">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="368" y="1288.6299">prepareSvReload(int amount)</text><ellipse cx="333" cy="1298.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1302.4658">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="368" y="1302.4658">prepareSvDebit(int amount, int date, int time)</text><ellipse cx="333" cy="1311.8828" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1316.3018">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="368" y="1316.3018">prepareSvDebit(int amount, byte[] date, byte[] time)</text><ellipse cx="333" cy="1325.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1330.1377">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="368" y="1330.1377">prepareSvDebit(int amount)</text><ellipse cx="333" cy="1339.5547" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1343.9736">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="368" y="1343.9736">SvOperationSecureData getSvOperationSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1357.8096"/><ellipse cx="333" cy="1367.2266" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1371.6455">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="368" y="1371.6455">prepareSelectFile(short lid)</text><ellipse cx="333" cy="1381.0625" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1385.4814">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="368" y="1385.4814">prepareSelectFile(byte[] lid)</text><ellipse cx="333" cy="1394.8984" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1399.3174">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="368" y="1399.3174">prepareSelectFile(SelectFileControl control)</text><ellipse cx="333" cy="1408.7344" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1413.1533">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="368" y="1413.1533">prepareReadRecordFile(byte sfi, int recordNumber)</text><ellipse cx="333" cy="1422.5703" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1426.9893">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="455" x="368" y="1426.9893">prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))</text><ellipse cx="333" cy="1436.4063" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1440.8252">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="559" x="368" y="1440.8252">prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)</text><ellipse cx="333" cy="1450.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1454.6611">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="324" x="368" y="1454.6611">prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)</text><ellipse cx="333" cy="1464.0781" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1468.4971">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="368" y="1468.4971">prepareReadCounterFile(byte sfi, int countersNumber)</text><ellipse cx="333" cy="1477.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1482.333">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="368" y="1482.333">prepareAppendRecord(byte sfi, byte[] recordData)</text><ellipse cx="333" cy="1491.75" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1496.1689">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="368" y="1496.1689">prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="333" cy="1505.5859" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1510.0049">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="321" x="368" y="1510.0049">prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="333" cy="1519.4219" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1523.8408">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="331" x="368" y="1523.8408">prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="333" cy="1533.2578" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1537.6768">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="368" y="1537.6768">prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="333" cy="1547.0938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1551.5127">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="368" y="1551.5127">prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)</text><ellipse cx="333" cy="1560.9297" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1565.3486">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="327" x="368" y="1565.3486">prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)</text><ellipse cx="333" cy="1574.7656" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1579.1846">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="368" y="1579.1846">prepareSetCounter(byte sfi, int counterNumber, int newValue)</text><ellipse cx="333" cy="1588.6016" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1593.0205">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="712" x="368" y="1593.0205">int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)</text><ellipse cx="333" cy="1602.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1606.8564">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="368" y="1606.8564">int[] getSearchResult(int searchRequestNumber)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1620.6924"/><ellipse cx="333" cy="1630.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1634.5283">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="368" y="1634.5283">prepareInvalidate()</text><ellipse cx="333" cy="1643.9453" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1648.3643">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="368" y="1648.3643">prepareRehabilitate()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="345" y="1662.2002"/><ellipse cx="333" cy="1671.6172" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1676.0361">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="368" y="1676.0361">prepareChangeKey(AccessLevel level)</text><ellipse cx="333" cy="1685.4531" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1689.8721">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="368" y="1689.8721">prepareChangePin(String pin)</text><ellipse cx="333" cy="1699.2891" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="342" y="1703.708">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="368" y="1703.708">prepareChangePin(byte[] pin)</text><!--MD5=[2242c43c330acc437358859ea7f59776]
class SessionState--><rect fill="#FEFECE" height="89.5078" id="SessionState" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="660.5" y="1770"/><ellipse cx="679.1" cy="1786" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M677.6,1787 L677.6,1789 L681.6,1789 L681.6,1788 L681.6,1787.5156 L682.225,1787 L682.6,1787 L682.975,1787 L683.6,1787.5156 L683.6,1788 L683.6,1791 L675.6,1791 L675.1156,1791 L674.6,1790.375 L674.6,1790 L674.6,1789.625 L675.1156,1789 L675.6,1789 L675.6,1789 L675.6,1783 L675.6,1783 L675.1156,1783 L674.6,1782.375 L674.6,1782 L674.6,1781.625 L675.1156,1781 L675.6,1781 L683.6,1781 L683.6,1784 L683.6,1784.4844 L682.975,1785 L682.6,1785 L682.225,1785 L681.6,1784.4844 L681.6,1784 L681.6,1783 L677.6,1783 L677.6,1785 L678.6,1785 L678.6,1784.5156 L678.6,1784.5156 L679.225,1784 L679.6,1784 L679.975,1784 L680.6,1784.5156 L680.6,1785 L680.6,1787 L680.6,1787.4844 L679.975,1788 L679.975,1788 L679.6,1788 L679.225,1788 L678.6,1787.4844 L678.6,1787.4844 L678.6,1787 L677.6,1787 Z "/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="695.9" y="1782.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="704.9" y="1790.9102">SessionState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="661.5" x2="784.5" y1="1802" y2="1802"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="666.5" y="1817.4189">SESSION_UNITIALIZED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="666.5" y="1831.2549">SESSION_OPEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="666.5" y="1845.0908">SESSION_CLOSED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="661.5" x2="784.5" y1="1851.5078" y2="1851.5078"/><!--MD5=[bf7a0c1c8b34ad25b46528e084cfcf9f]
class SessionSetting--><rect fill="#FEFECE" height="48" id="SessionSetting" style="stroke: #A80036; stroke-width: 1.5;" width="154" x="821" y="1791"/><ellipse cx="836" cy="1807" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M838,1803.5 Q838.2031,1803 838.4375,1802.75 Q838.6719,1802.5 838.9375,1802.5 Q839.4063,1802.5 839.7031,1802.7813 Q840,1803.0625 840,1803.7188 L840,1805.2813 Q840,1805.9375 839.7188,1806.2188 Q839.4375,1806.5 839,1806.5 Q838.6094,1806.5 838.3594,1806.3281 Q838.1094,1806.1563 838,1805.7031 Q837.9531,1805.3906 837.7813,1805.2188 Q837.4688,1804.8906 836.9063,1804.7031 Q836.3438,1804.5 835.7813,1804.5 Q835.0781,1804.5 834.4844,1804.7813 Q833.9063,1805.0625 833.4531,1805.6875 Q833,1806.3125 833,1807.1719 L833,1808.0938 Q833,1809.125 833.8438,1809.8125 Q834.6875,1810.5 836.1875,1810.5 Q837.0781,1810.5 837.7031,1810.2969 Q838.0625,1810.1875 838.4688,1809.8281 Q838.7344,1809.625 838.875,1809.5625 Q839.0156,1809.5 839.1875,1809.5 Q839.5156,1809.5 839.75,1809.7656 Q840,1810.0156 840,1810.375 Q840,1810.7188 839.6563,1811.125 Q839.1563,1811.7188 838.3594,1812.0469 Q837.3125,1812.5 836.0313,1812.5 Q834.5313,1812.5 833.3281,1811.9063 Q832.3594,1811.4375 831.6719,1810.4219 Q831,1809.4063 831,1808.2031 L831,1807.1094 Q831,1805.8594 831.5938,1804.7656 Q832.2031,1803.6719 833.25,1803.0938 Q834.3125,1802.5 835.5,1802.5 Q836.2188,1802.5 836.8438,1802.75 Q837.4688,1803 838,1803.5 Z "/><ellipse cx="855" cy="1806.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="861" y="1811.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="888" y="1811.9102">SessionSetting</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="822" x2="974" y1="1823" y2="1823"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="822" x2="974" y1="1831" y2="1831"/><!--MD5=[45c40070d26b32101cf9b7ab72916b9e]
class AccessLevel--><rect fill="#FEFECE" height="89.5078" id="AccessLevel" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="784.5" y="2056"/><ellipse cx="851.75" cy="2072" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M850.25,2073 L850.25,2075 L854.25,2075 L854.25,2074 L854.25,2073.5156 L854.875,2073 L855.25,2073 L855.625,2073 L856.25,2073.5156 L856.25,2074 L856.25,2077 L848.25,2077 L847.7656,2077 L847.25,2076.375 L847.25,2076 L847.25,2075.625 L847.7656,2075 L848.25,2075 L848.25,2075 L848.25,2069 L848.25,2069 L847.7656,2069 L847.25,2068.375 L847.25,2068 L847.25,2067.625 L847.7656,2067 L848.25,2067 L856.25,2067 L856.25,2070 L856.25,2070.4844 L855.625,2071 L855.25,2071 L854.875,2071 L854.25,2070.4844 L854.25,2070 L854.25,2069 L850.25,2069 L850.25,2071 L851.25,2071 L851.25,2070.5156 L851.25,2070.5156 L851.875,2070 L852.25,2070 L852.625,2070 L853.25,2070.5156 L853.25,2071 L853.25,2073 L853.25,2073.4844 L852.625,2074 L852.625,2074 L852.25,2074 L851.875,2074 L851.25,2073.4844 L851.25,2073.4844 L851.25,2073 L850.25,2073 Z "/><ellipse cx="877.25" cy="2071.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="883.25" y="2076.9102">AccessLevel</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="785.5" x2="1006.5" y1="2088" y2="2088"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="785.5" x2="1006.5" y1="2096" y2="2096"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="790.5" y="2111.4189">SESSION_LVL_PERSO("perso", byte 0x01),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="790.5" y="2125.2549">SESSION_LVL_LOAD("load", byte 0x02),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="790.5" y="2139.0908">SESSION_LVL_DEBIT("debit", byte 0x03)</text><!--MD5=[e19a48d2c11a8f9a6a11f4ef9a7d8d18]
class ModificationMode--><rect fill="#FEFECE" height="75.6719" id="ModificationMode" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="459" y="1920"/><ellipse cx="474" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M472.5,1937 L472.5,1939 L476.5,1939 L476.5,1938 L476.5,1937.5156 L477.125,1937 L477.5,1937 L477.875,1937 L478.5,1937.5156 L478.5,1938 L478.5,1941 L470.5,1941 L470.0156,1941 L469.5,1940.375 L469.5,1940 L469.5,1939.625 L470.0156,1939 L470.5,1939 L470.5,1939 L470.5,1933 L470.5,1933 L470.0156,1933 L469.5,1932.375 L469.5,1932 L469.5,1931.625 L470.0156,1931 L470.5,1931 L478.5,1931 L478.5,1934 L478.5,1934.4844 L477.875,1935 L477.5,1935 L477.125,1935 L476.5,1934.4844 L476.5,1934 L476.5,1933 L472.5,1933 L472.5,1935 L473.5,1935 L473.5,1934.5156 L473.5,1934.5156 L474.125,1934 L474.5,1934 L474.875,1934 L475.5,1934.5156 L475.5,1935 L475.5,1937 L475.5,1937.4844 L474.875,1938 L474.875,1938 L474.5,1938 L474.125,1938 L473.5,1937.4844 L473.5,1937.4844 L473.5,1937 L472.5,1937 Z "/><ellipse cx="493" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="499" y="1940.9102">ModificationMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="460" x2="596" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="465" y="1967.4189">ATOMIC,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="465" y="1981.2549">MULTIPLE</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="460" x2="596" y1="1987.6719" y2="1987.6719"/><!--MD5=[139c679d0f2db6318e7e57d2f6dd7d7b]
class RatificationMode--><rect fill="#FEFECE" height="75.6719" id="RatificationMode" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="632" y="1920"/><ellipse cx="647" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M645.5,1937 L645.5,1939 L649.5,1939 L649.5,1938 L649.5,1937.5156 L650.125,1937 L650.5,1937 L650.875,1937 L651.5,1937.5156 L651.5,1938 L651.5,1941 L643.5,1941 L643.0156,1941 L642.5,1940.375 L642.5,1940 L642.5,1939.625 L643.0156,1939 L643.5,1939 L643.5,1939 L643.5,1933 L643.5,1933 L643.0156,1933 L642.5,1932.375 L642.5,1932 L642.5,1931.625 L643.0156,1931 L643.5,1931 L651.5,1931 L651.5,1934 L651.5,1934.4844 L650.875,1935 L650.5,1935 L650.125,1935 L649.5,1934.4844 L649.5,1934 L649.5,1933 L645.5,1933 L645.5,1935 L646.5,1935 L646.5,1934.5156 L646.5,1934.5156 L647.125,1934 L647.5,1934 L647.875,1934 L648.5,1934.5156 L648.5,1935 L648.5,1937 L648.5,1937.4844 L647.875,1938 L647.875,1938 L647.5,1938 L647.125,1938 L646.5,1937.4844 L646.5,1937.4844 L646.5,1937 L645.5,1937 Z "/><ellipse cx="666" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="672" y="1940.9102">RatificationMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="765" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="638" y="1967.4189">CLOSE_RATIFIED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="638" y="1981.2549">CLOSE_NOT_RATIFIED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="765" y1="1987.6719" y2="1987.6719"/><!--MD5=[ce8182edd4590e04a2102797ac389b3e]
class EncryptionMode--><rect fill="#FEFECE" height="75.6719" id="EncryptionMode" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="838" y="1920"/><ellipse cx="853" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M851.5,1937 L851.5,1939 L855.5,1939 L855.5,1938 L855.5,1937.5156 L856.125,1937 L856.5,1937 L856.875,1937 L857.5,1937.5156 L857.5,1938 L857.5,1941 L849.5,1941 L849.0156,1941 L848.5,1940.375 L848.5,1940 L848.5,1939.625 L849.0156,1939 L849.5,1939 L849.5,1939 L849.5,1933 L849.5,1933 L849.0156,1933 L848.5,1932.375 L848.5,1932 L848.5,1931.625 L849.0156,1931 L849.5,1931 L857.5,1931 L857.5,1934 L857.5,1934.4844 L856.875,1935 L856.5,1935 L856.125,1935 L855.5,1934.4844 L855.5,1934 L855.5,1933 L851.5,1933 L851.5,1935 L852.5,1935 L852.5,1934.5156 L852.5,1934.5156 L853.125,1934 L853.5,1934 L853.875,1934 L854.5,1934.5156 L854.5,1935 L854.5,1937 L854.5,1937.4844 L853.875,1938 L853.875,1938 L853.5,1938 L853.125,1938 L852.5,1937.4844 L852.5,1937.4844 L852.5,1937 L851.5,1937 Z "/><ellipse cx="872" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="878" y="1940.9102">EncryptionMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="839" x2="967" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="54" x="844" y="1967.4189">ACTIVATE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="844" y="1981.2549">DEACTIVATE</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="839" x2="967" y1="1987.6719" y2="1987.6719"/><!--MD5=[587c29523c7e651cb28d7191d1daa746]
class AuthenticationMode--><rect fill="#FEFECE" height="75.6719" id="AuthenticationMode" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="599" y="2063"/><ellipse cx="614" cy="2079" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M612.5,2080 L612.5,2082 L616.5,2082 L616.5,2081 L616.5,2080.5156 L617.125,2080 L617.5,2080 L617.875,2080 L618.5,2080.5156 L618.5,2081 L618.5,2084 L610.5,2084 L610.0156,2084 L609.5,2083.375 L609.5,2083 L609.5,2082.625 L610.0156,2082 L610.5,2082 L610.5,2082 L610.5,2076 L610.5,2076 L610.0156,2076 L609.5,2075.375 L609.5,2075 L609.5,2074.625 L610.0156,2074 L610.5,2074 L618.5,2074 L618.5,2077 L618.5,2077.4844 L617.875,2078 L617.5,2078 L617.125,2078 L616.5,2077.4844 L616.5,2077 L616.5,2076 L612.5,2076 L612.5,2078 L613.5,2078 L613.5,2077.5156 L613.5,2077.5156 L614.125,2077 L614.5,2077 L614.875,2077 L615.5,2077.5156 L615.5,2078 L615.5,2080 L615.5,2080.4844 L614.875,2081 L614.875,2081 L614.5,2081 L614.125,2081 L613.5,2080.4844 L613.5,2080.4844 L613.5,2080 L612.5,2080 Z "/><ellipse cx="633" cy="2078.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="639" y="2083.9102">AuthenticationMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="600" x2="748" y1="2095" y2="2095"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="605" y="2110.4189">REQUESTED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="605" y="2124.2549">NOT_REQUESTED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="600" x2="748" y1="2130.6719" y2="2130.6719"/><!--MD5=[69e7de8796175c80a787a8fe6d04a077]
class PinTransmissionMode--><rect fill="#FEFECE" height="75.6719" id="PinTransmissionMode" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="457" y="1777"/><ellipse cx="472" cy="1793" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M470.5,1794 L470.5,1796 L474.5,1796 L474.5,1795 L474.5,1794.5156 L475.125,1794 L475.5,1794 L475.875,1794 L476.5,1794.5156 L476.5,1795 L476.5,1798 L468.5,1798 L468.0156,1798 L467.5,1797.375 L467.5,1797 L467.5,1796.625 L468.0156,1796 L468.5,1796 L468.5,1796 L468.5,1790 L468.5,1790 L468.0156,1790 L467.5,1789.375 L467.5,1789 L467.5,1788.625 L468.0156,1788 L468.5,1788 L476.5,1788 L476.5,1791 L476.5,1791.4844 L475.875,1792 L475.5,1792 L475.125,1792 L474.5,1791.4844 L474.5,1791 L474.5,1790 L470.5,1790 L470.5,1792 L471.5,1792 L471.5,1791.5156 L471.5,1791.5156 L472.125,1791 L472.5,1791 L472.875,1791 L473.5,1791.5156 L473.5,1792 L473.5,1794 L473.5,1794.4844 L472.875,1795 L472.875,1795 L472.5,1795 L472.125,1795 L471.5,1794.4844 L471.5,1794.4844 L471.5,1794 L470.5,1794 Z "/><ellipse cx="491" cy="1792.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="125" x="497" y="1797.9102">PinTransmissionMode</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="458" x2="624" y1="1809" y2="1809"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="463" y="1824.4189">PLAIN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="463" y="1838.2549">ENCRYPTED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="458" x2="624" y1="1844.6719" y2="1844.6719"/><!--MD5=[2296a6a537aebb6d062261368584c4c8]
class PoRevokedService--><rect fill="#FEFECE" height="61.8359" id="PoRevokedService" style="stroke: #A80036; stroke-width: 1.5;" width="186" x="86" y="111"/><ellipse cx="117.65" cy="127" fill="#B4A7E5" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M118.65,124 L118.65,130 L120.65,130 L121.1344,130 L121.65,130.625 L121.65,131 L121.65,131.375 L121.1344,132 L120.65,132 L114.65,132 L114.1656,132 L113.65,131.375 L113.65,131 L113.65,130.625 L114.1656,130 L114.65,130 L116.65,130 L116.65,124 L114.65,124 L114.1656,124 L113.65,123.375 L113.65,123 L113.65,122.625 L114.1656,122 L114.65,122 L120.65,122 L121.1344,122 L121.65,122.625 L121.65,123 L121.65,123.375 L121.1344,124 L120.65,124 L118.65,124 Z "/><ellipse cx="140.35" cy="126.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="106" x="146.35" y="131.9102">PoRevokedService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="271" y1="143" y2="143"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="271" y1="151" y2="151"/><ellipse cx="97" cy="162" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="106" y="166.4189">isPoRevoked(byte[] 8bytesSerial)</text><path d="M307.5,88 L307.5,196.1094 L740.5,196.1094 L740.5,98 L730.5,88 L307.5,88 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M730.5,88 L730.5,98 L740.5,98 L730.5,88 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="405" x="313.5" y="106.4951">Default values in PoTransaction if PoSecuritySetting doesn't specify it:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="321.5" y="122.8467">- session ModificationMode as ATOMIC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="321.5" y="139.1982">- session RatificationMode as CLOSE_RATIFIED</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="321.5" y="155.5498">- PinTransmissionMode as ENCRYPTED if PoSecurity defined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="321.5" y="171.9014">- any KIF/KVC values are authorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="321.5" y="188.2529">- no verification is done for: HCE token expiration, revoked PO or SAM</text><!--MD5=[80e74f8fe2d788e9d347a51040ef83af]
class SamRevokedService--><rect fill="#FEFECE" height="61.8359" id="SamRevokedService" style="stroke: #A80036; stroke-width: 1.5;" width="326" x="776" y="111"/><ellipse cx="870.75" cy="127" fill="#B4A7E5" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M871.75,124 L871.75,130 L873.75,130 L874.2344,130 L874.75,130.625 L874.75,131 L874.75,131.375 L874.2344,132 L873.75,132 L867.75,132 L867.2656,132 L866.75,131.375 L866.75,131 L866.75,130.625 L867.2656,130 L867.75,130 L869.75,130 L869.75,124 L867.75,124 L867.2656,124 L866.75,123.375 L866.75,123 L866.75,122.625 L867.2656,122 L867.75,122 L873.75,122 L874.2344,122 L874.75,122.625 L874.75,123 L874.75,123.375 L874.2344,124 L873.75,124 L871.75,124 Z "/><ellipse cx="896.25" cy="126.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="117" x="902.25" y="131.9102">SamRevokedService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="777" x2="1101" y1="143" y2="143"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="777" x2="1101" y1="151" y2="151"/><ellipse cx="787" cy="162" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="796" y="166.4189">isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)</text><!--MD5=[1ac61061803296a84828c176919fd8e8]
class PoHceService--><rect fill="#FEFECE" height="61.8359" id="PoHceService" style="stroke: #A80036; stroke-width: 1.5;" width="317" x="141.5" y="456.5"/><ellipse cx="251.25" cy="472.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M252.25,469.5 L252.25,475.5 L254.25,475.5 L254.7344,475.5 L255.25,476.125 L255.25,476.5 L255.25,476.875 L254.7344,477.5 L254.25,477.5 L248.25,477.5 L247.7656,477.5 L247.25,476.875 L247.25,476.5 L247.25,476.125 L247.7656,475.5 L248.25,475.5 L250.25,475.5 L250.25,469.5 L248.25,469.5 L247.7656,469.5 L247.25,468.875 L247.25,468.5 L247.25,468.125 L247.7656,467.5 L248.25,467.5 L254.25,467.5 L254.7344,467.5 L255.25,468.125 L255.25,468.5 L255.25,468.875 L254.7344,469.5 L254.25,469.5 L252.25,469.5 Z "/><ellipse cx="276.75" cy="472" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="78" x="282.75" y="477.4102">PoHceService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="142.5" x2="457.5" y1="488.5" y2="488.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="142.5" x2="457.5" y1="496.5" y2="496.5"/><ellipse cx="152.5" cy="507.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="291" x="161.5" y="511.9189">boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)</text><!--MD5=[e4d4ea7db949ad9d239210033b878e09]
class PoSecuritySetting--><rect fill="#FEFECE" height="463.0781" id="PoSecuritySetting" style="stroke: #A80036; stroke-width: 1.5;" width="315" x="493.5" y="256"/><ellipse cx="579.75" cy="272" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M581.75,268.5 Q581.9531,268 582.1875,267.75 Q582.4219,267.5 582.6875,267.5 Q583.1563,267.5 583.4531,267.7813 Q583.75,268.0625 583.75,268.7188 L583.75,270.2813 Q583.75,270.9375 583.4688,271.2188 Q583.1875,271.5 582.75,271.5 Q582.3594,271.5 582.1094,271.3281 Q581.8594,271.1563 581.75,270.7031 Q581.7031,270.3906 581.5313,270.2188 Q581.2188,269.8906 580.6563,269.7031 Q580.0938,269.5 579.5313,269.5 Q578.8281,269.5 578.2344,269.7813 Q577.6563,270.0625 577.2031,270.6875 Q576.75,271.3125 576.75,272.1719 L576.75,273.0938 Q576.75,274.125 577.5938,274.8125 Q578.4375,275.5 579.9375,275.5 Q580.8281,275.5 581.4531,275.2969 Q581.8125,275.1875 582.2188,274.8281 Q582.4844,274.625 582.625,274.5625 Q582.7656,274.5 582.9375,274.5 Q583.2656,274.5 583.5,274.7656 Q583.75,275.0156 583.75,275.375 Q583.75,275.7188 583.4063,276.125 Q582.9063,276.7188 582.1094,277.0469 Q581.0625,277.5 579.7813,277.5 Q578.2813,277.5 577.0781,276.9063 Q576.1094,276.4375 575.4219,275.4219 Q574.75,274.4063 574.75,273.2031 L574.75,272.1094 Q574.75,270.8594 575.3438,269.7656 Q575.9531,268.6719 577,268.0938 Q578.0625,267.5 579.25,267.5 Q579.9688,267.5 580.5938,267.75 Q581.2188,268 581.75,268.5 Z "/><ellipse cx="605.25" cy="271.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="611.25" y="276.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="638.25" y="276.9102">PoSecuritySetting</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="494.5" x2="807.5" y1="288" y2="288"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="494.5" x2="807.5" y1="296" y2="296"/><ellipse cx="504.5" cy="307" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="513.5" y="311.4189">PoSecuritySetting(SamResource samResource);</text><ellipse cx="504.5" cy="320.8359" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="259" x="513.5" y="325.2549">setPoRevokedService(PoRevokedService revokedPo)</text><ellipse cx="504.5" cy="334.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="286" x="513.5" y="339.0908">setSamRevokedService(SamRevokedService revokedSam)</text><ellipse cx="504.5" cy="348.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="513.5" y="352.9268">setPoHceService(PoHceService expiredHce)</text><polygon fill="#FFFF44" points="504.5,357.3438,508.5,361.3438,504.5,365.3438,500.5,361.3438" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="513.5" y="366.7627">PoRevokedService getPoRevokedService()</text><polygon fill="#FFFF44" points="504.5,371.1797,508.5,375.1797,504.5,379.1797,500.5,375.1797" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="513.5" y="380.5986">SamRevokedService getSamRevokedService()</text><polygon fill="#FFFF44" points="504.5,385.0156,508.5,389.0156,504.5,393.0156,500.5,389.0156" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="513.5" y="394.4346">PoHceService getPoHceService()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="516.5" y="408.2705"/><ellipse cx="504.5" cy="417.6875" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="513.5" y="422.1064">loadProperties(Properties propertyFile)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="516.5" y="435.9424"/><ellipse cx="504.5" cy="445.3594" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="513.5" y="449.7783">setSessionModificationMode(ModificationMode mode)</text><ellipse cx="504.5" cy="459.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="249" x="513.5" y="463.6143">setSessionRatificationMode(RatificationMode mode)</text><ellipse cx="504.5" cy="473.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="239" x="513.5" y="477.4502">setSessionDefaultKif(AccessLevel level, byte kif)</text><ellipse cx="504.5" cy="486.8672" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="251" x="513.5" y="491.2861">setSessionDefaultKvc(AccessLevel level, byte kvc)</text><ellipse cx="504.5" cy="500.7031" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="513.5" y="505.1221">setSessionAuthorizedKvcList(byte[] kvc)</text><polygon fill="#FFFF44" points="504.5,509.5391,508.5,513.5391,504.5,517.5391,500.5,513.5391" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="513.5" y="518.958">ModificationMode getSessionModificationMode()</text><polygon fill="#FFFF44" points="504.5,523.375,508.5,527.375,504.5,531.375,500.5,527.375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="513.5" y="532.7939">RatificationMode getSessionRatificationMode()</text><polygon fill="#FFFF44" points="504.5,537.2109,508.5,541.2109,504.5,545.2109,500.5,541.2109" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="513.5" y="546.6299">Byte getSessionDefaultKif(AccessLevel level)</text><polygon fill="#FFFF44" points="504.5,551.0469,508.5,555.0469,504.5,559.0469,500.5,555.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="513.5" y="560.4658">Byte getSessionDefaultKvc(AccessLevel level)</text><polygon fill="#FFFF44" points="504.5,564.8828,508.5,568.8828,504.5,572.8828,500.5,568.8828" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="513.5" y="574.3018">Boolean isSessionKvcAuthorized(byte kvc)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="516.5" y="588.1377"/><ellipse cx="504.5" cy="597.5547" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="513.5" y="601.9736">setPinTransmissionMode(PinTransmissionMode mode)</text><polygon fill="#FFFF44" points="504.5,606.3906,508.5,610.3906,504.5,614.3906,500.5,610.3906" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="513.5" y="615.8096">PinTransmissionMode getPinTransmissionMode()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="516.5" y="629.6455"/><ellipse cx="504.5" cy="639.0625" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="513.5" y="643.4814">setSvGetLogReadMode(LogRead readRule)</text><ellipse cx="504.5" cy="652.8984" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="289" x="513.5" y="657.3174">setSvNegativeBalanceMode(NegativeBalance authorization)</text><ellipse cx="504.5" cy="666.7344" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="513.5" y="671.1533">setSvAuthorizedKvcList(byte[] kvc)</text><polygon fill="#FFFF44" points="504.5,675.5703,508.5,679.5703,504.5,683.5703,500.5,679.5703" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="513.5" y="684.9893">LogRead getSvGetLogReadMode()</text><polygon fill="#FFFF44" points="504.5,689.4063,508.5,693.4063,504.5,697.4063,500.5,693.4063" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="513.5" y="698.8252">NegativeBalance getSvNegativeBalance()</text><polygon fill="#FFFF44" points="504.5,703.2422,508.5,707.2422,504.5,711.2422,500.5,707.2422" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="513.5" y="712.6611">Boolean isSvKvcAuthorized(byte kvc)</text><!--MD5=[43918d86839edc1befb88ea50efcfbfb]
class SamResource--><rect fill="#FEFECE" height="75.6719" id="SamResource" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="843.5" y="449.5"/><ellipse cx="860.3" cy="465.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M862.3,462 Q862.5031,461.5 862.7375,461.25 Q862.9719,461 863.2375,461 Q863.7063,461 864.0031,461.2813 Q864.3,461.5625 864.3,462.2188 L864.3,463.7813 Q864.3,464.4375 864.0188,464.7188 Q863.7375,465 863.3,465 Q862.9094,465 862.6594,464.8281 Q862.4094,464.6563 862.3,464.2031 Q862.2531,463.8906 862.0813,463.7188 Q861.7688,463.3906 861.2063,463.2031 Q860.6438,463 860.0813,463 Q859.3781,463 858.7844,463.2813 Q858.2063,463.5625 857.7531,464.1875 Q857.3,464.8125 857.3,465.6719 L857.3,466.5938 Q857.3,467.625 858.1438,468.3125 Q858.9875,469 860.4875,469 Q861.3781,469 862.0031,468.7969 Q862.3625,468.6875 862.7688,468.3281 Q863.0344,468.125 863.175,468.0625 Q863.3156,468 863.4875,468 Q863.8156,468 864.05,468.2656 Q864.3,468.5156 864.3,468.875 Q864.3,469.2188 863.9563,469.625 Q863.4563,470.2188 862.6594,470.5469 Q861.6125,471 860.3313,471 Q858.8313,471 857.6281,470.4063 Q856.6594,469.9375 855.9719,468.9219 Q855.3,467.9063 855.3,466.7031 L855.3,465.6094 Q855.3,464.3594 855.8938,463.2656 Q856.5031,462.1719 857.55,461.5938 Q858.6125,461 859.8,461 Q860.5188,461 861.1438,461.25 Q861.7688,461.5 862.3,462 Z "/><ellipse cx="879.7" cy="465" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="885.7" y="470.4102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="73" x="964.5" y="446.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="71" x="965.5" y="459.957">CalypsoSam</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="844.5" x2="1033.5" y1="481.5" y2="481.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="844.5" x2="1033.5" y1="489.5" y2="489.5"/><ellipse cx="854.5" cy="500.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="863.5" y="504.9189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="927.5" y="504.9189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="1025.5" y="504.9189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="863.5" y="518.7549">CalypsoSam sam);</text><!--MD5=[7d16591ce1ac0fb103d5c2b0f24533d6]
class SvSetting--><rect fill="#FEFECE" height="48" id="SvSetting" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="129.5" y="1791"/><ellipse cx="144.5" cy="1807" fill="#ADD1B2" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M146.5,1803.5 Q146.7031,1803 146.9375,1802.75 Q147.1719,1802.5 147.4375,1802.5 Q147.9063,1802.5 148.2031,1802.7813 Q148.5,1803.0625 148.5,1803.7188 L148.5,1805.2813 Q148.5,1805.9375 148.2188,1806.2188 Q147.9375,1806.5 147.5,1806.5 Q147.1094,1806.5 146.8594,1806.3281 Q146.6094,1806.1563 146.5,1805.7031 Q146.4531,1805.3906 146.2813,1805.2188 Q145.9688,1804.8906 145.4063,1804.7031 Q144.8438,1804.5 144.2813,1804.5 Q143.5781,1804.5 142.9844,1804.7813 Q142.4063,1805.0625 141.9531,1805.6875 Q141.5,1806.3125 141.5,1807.1719 L141.5,1808.0938 Q141.5,1809.125 142.3438,1809.8125 Q143.1875,1810.5 144.6875,1810.5 Q145.5781,1810.5 146.2031,1810.2969 Q146.5625,1810.1875 146.9688,1809.8281 Q147.2344,1809.625 147.375,1809.5625 Q147.5156,1809.5 147.6875,1809.5 Q148.0156,1809.5 148.25,1809.7656 Q148.5,1810.0156 148.5,1810.375 Q148.5,1810.7188 148.1563,1811.125 Q147.6563,1811.7188 146.8594,1812.0469 Q145.8125,1812.5 144.5313,1812.5 Q143.0313,1812.5 141.8281,1811.9063 Q140.8594,1811.4375 140.1719,1810.4219 Q139.5,1809.4063 139.5,1808.2031 L139.5,1807.1094 Q139.5,1805.8594 140.0938,1804.7656 Q140.7031,1803.6719 141.75,1803.0938 Q142.8125,1802.5 144,1802.5 Q144.7188,1802.5 145.3438,1802.75 Q145.9688,1803 146.5,1803.5 Z "/><ellipse cx="163.5" cy="1806.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="169.5" y="1811.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="196.5" y="1811.9102">SvSetting</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="130.5" x2="249.5" y1="1823" y2="1823"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="130.5" x2="249.5" y1="1831" y2="1831"/><!--MD5=[cca5d97aaf46870920fae66c9bd85cdd]
class Operation--><rect fill="#FEFECE" height="75.6719" id="Operation" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="215.5" y="1920"/><ellipse cx="230.5" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M229,1937 L229,1939 L233,1939 L233,1938 L233,1937.5156 L233.625,1937 L234,1937 L234.375,1937 L235,1937.5156 L235,1938 L235,1941 L227,1941 L226.5156,1941 L226,1940.375 L226,1940 L226,1939.625 L226.5156,1939 L227,1939 L227,1939 L227,1933 L227,1933 L226.5156,1933 L226,1932.375 L226,1932 L226,1931.625 L226.5156,1931 L227,1931 L235,1931 L235,1934 L235,1934.4844 L234.375,1935 L234,1935 L233.625,1935 L233,1934.4844 L233,1934 L233,1933 L229,1933 L229,1935 L230,1935 L230,1934.5156 L230,1934.5156 L230.625,1934 L231,1934 L231.375,1934 L232,1934.5156 L232,1935 L232,1937 L232,1937.4844 L231.375,1938 L231.375,1938 L231,1938 L230.625,1938 L230,1937.4844 L230,1937.4844 L230,1937 L229,1937 Z "/><ellipse cx="249.5" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="255.5" y="1940.9102">Operation</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="216.5" x2="311.5" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="221.5" y="1967.4189">RELOAD,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="221.5" y="1981.2549">DEBIT</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="216.5" x2="311.5" y1="1987.6719" y2="1987.6719"/><!--MD5=[f8e7078f77c005d15b486c0c98deb1e6]
class Action--><rect fill="#FEFECE" height="75.6719" id="Action" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="348" y="1920"/><ellipse cx="363" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M361.5,1937 L361.5,1939 L365.5,1939 L365.5,1938 L365.5,1937.5156 L366.125,1937 L366.5,1937 L366.875,1937 L367.5,1937.5156 L367.5,1938 L367.5,1941 L359.5,1941 L359.0156,1941 L358.5,1940.375 L358.5,1940 L358.5,1939.625 L359.0156,1939 L359.5,1939 L359.5,1939 L359.5,1933 L359.5,1933 L359.0156,1933 L358.5,1932.375 L358.5,1932 L358.5,1931.625 L359.0156,1931 L359.5,1931 L367.5,1931 L367.5,1934 L367.5,1934.4844 L366.875,1935 L366.5,1935 L366.125,1935 L365.5,1934.4844 L365.5,1934 L365.5,1933 L361.5,1933 L361.5,1935 L362.5,1935 L362.5,1934.5156 L362.5,1934.5156 L363.125,1934 L363.5,1934 L363.875,1934 L364.5,1934.5156 L364.5,1935 L364.5,1937 L364.5,1937.4844 L363.875,1938 L363.875,1938 L363.5,1938 L363.125,1938 L362.5,1937.4844 L362.5,1937.4844 L362.5,1937 L361.5,1937 Z "/><ellipse cx="382" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="388" y="1940.9102">Action</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="349" x2="423" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="354" y="1967.4189">DO,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="29" x="354" y="1981.2549">UNDO</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="349" x2="423" y1="1987.6719" y2="1987.6719"/><!--MD5=[67d91b3e56e3fb89140abbb352fa8438]
class LogRead--><rect fill="#FEFECE" height="75.6719" id="LogRead" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="86" y="1920"/><ellipse cx="101" cy="1936" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M99.5,1937 L99.5,1939 L103.5,1939 L103.5,1938 L103.5,1937.5156 L104.125,1937 L104.5,1937 L104.875,1937 L105.5,1937.5156 L105.5,1938 L105.5,1941 L97.5,1941 L97.0156,1941 L96.5,1940.375 L96.5,1940 L96.5,1939.625 L97.0156,1939 L97.5,1939 L97.5,1939 L97.5,1933 L97.5,1933 L97.0156,1933 L96.5,1932.375 L96.5,1932 L96.5,1931.625 L97.0156,1931 L97.5,1931 L105.5,1931 L105.5,1934 L105.5,1934.4844 L104.875,1935 L104.5,1935 L104.125,1935 L103.5,1934.4844 L103.5,1934 L103.5,1933 L99.5,1933 L99.5,1935 L100.5,1935 L100.5,1934.5156 L100.5,1934.5156 L101.125,1934 L101.5,1934 L101.875,1934 L102.5,1934.5156 L102.5,1935 L102.5,1937 L102.5,1937.4844 L101.875,1938 L101.875,1938 L101.5,1938 L101.125,1938 L100.5,1937.4844 L100.5,1937.4844 L100.5,1937 L99.5,1937 Z "/><ellipse cx="120" cy="1935.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="126" y="1940.9102">LogRead</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="179" y1="1952" y2="1952"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="92" y="1967.4189">SINGLE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="92" y="1981.2549">ALL</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="179" y1="1987.6719" y2="1987.6719"/><!--MD5=[50d6b8eba543a732d1dd3c761d982397]
class NegativeBalance--><rect fill="#FEFECE" height="75.6719" id="NegativeBalance" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="286" y="1777"/><ellipse cx="301" cy="1793" fill="#EB937F" rx="11" ry="11" style="stroke: #FFFFCC; stroke-width: 1.0;"/><path d="M299.5,1794 L299.5,1796 L303.5,1796 L303.5,1795 L303.5,1794.5156 L304.125,1794 L304.5,1794 L304.875,1794 L305.5,1794.5156 L305.5,1795 L305.5,1798 L297.5,1798 L297.0156,1798 L296.5,1797.375 L296.5,1797 L296.5,1796.625 L297.0156,1796 L297.5,1796 L297.5,1796 L297.5,1790 L297.5,1790 L297.0156,1790 L296.5,1789.375 L296.5,1789 L296.5,1788.625 L297.0156,1788 L297.5,1788 L305.5,1788 L305.5,1791 L305.5,1791.4844 L304.875,1792 L304.5,1792 L304.125,1792 L303.5,1791.4844 L303.5,1791 L303.5,1790 L299.5,1790 L299.5,1792 L300.5,1792 L300.5,1791.5156 L300.5,1791.5156 L301.125,1791 L301.5,1791 L301.875,1791 L302.5,1791.5156 L302.5,1792 L302.5,1794 L302.5,1794.4844 L301.875,1795 L301.875,1795 L301.5,1795 L301.125,1795 L300.5,1794.4844 L300.5,1794.4844 L300.5,1794 L299.5,1794 Z "/><ellipse cx="320" cy="1792.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="326" y="1797.9102">NegativeBalance</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="287" x2="421" y1="1809" y2="1809"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="292" y="1824.4189">FORBIDDEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="292" y="1838.2549">AUTHORIZED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="287" x2="421" y1="1844.6719" y2="1844.6719"/><!--MD5=[d3bf6a84c114c295ec3fbc425bdfd5dd]
link PoRevokedService to N1--><!--MD5=[58adaac62f7474086b87e5028f26f048]
link N1 to SamRevokedService--><!--MD5=[c7931a5b3688f34377874a4d447492d9]
reverse link PoSecuritySetting to PoHceService--><path d="M480.03,487.5 C472.921,487.5 465.813,487.5 458.704,487.5 " fill="none" id="PoSecuritySetting&lt;-PoHceService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="493.257,487.5,487.257,483.5,481.257,487.5,487.257,491.5,493.257,487.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="478.3499" y="484.6142">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="459.2485" y="501.7284">0..1</text><!--MD5=[a40139effe78355afd96e1fe38f816a4]
reverse link PoSecuritySetting to SamResource--><path d="M822.022,487.5 C829.139,487.5 836.255,487.5 843.371,487.5 " fill="none" id="PoSecuritySetting&lt;-SamResource" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="808.781,487.5,814.781,491.5,820.781,487.5,814.781,483.5,808.781,487.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="816.6899" y="484.6142">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="813.3936" y="501.6076">0..1</text><!--MD5=[fabfb25c6922ca0223a52cadcead3358]
link PoRevokedService to PoHceService--><!--MD5=[553a2f1231a528299e1fdd03d75ee317]
link PoHceService to PoResource--><!--MD5=[df9e65eec241e7a0900f3f2cc1715dea]
link SamRevokedService to SamResource--><!--MD5=[f5f07a045c16f9b5b991b6ad223e4b75]
reverse link SamResource to CalypsoSam--><path d="M939,538.82 C939,600.69 939,706.38 939,778.97 " fill="none" id="SamResource&lt;-CalypsoSam" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="939,525.57,935,531.57,939,537.57,943,531.57,939,525.57" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="931.4203" y="546.7517">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="931.6664" y="768.1541">1</text><!--MD5=[49b2cd243b315032ac87ae560f8bd7c4]
reverse link SvSetting to Operation--><path d="M209.243,1852.665 C220.098,1873.349 233.627,1899.127 244.521,1919.885 " fill="none" id="SvSetting&lt;-Operation" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="205.9381" cy="1846.3665" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="209.6562" x2="202.22" y1="1853.4499" y2="1839.283"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="198.8546" x2="213.0216" y1="1850.0846" y2="1842.6484"/><!--MD5=[ad0f2bead1761192d1c3cbd4a713f69a]
reverse link SvSetting to Action--><path d="M234.795,1848.225 C268.953,1872.798 315.484,1906.272 347.871,1929.571 " fill="none" id="SvSetting&lt;-Action" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="228.8592" cy="1843.9548" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="235.3534" x2="222.365" y1="1848.6266" y2="1839.283"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="224.1874" x2="233.531" y1="1850.449" y2="1837.4606"/><!--MD5=[40b37511570e7b53b6592a746222781a]
reverse link SvSetting to LogRead--><path d="M174.936,1853.263 C166.616,1873.845 156.315,1899.327 148.004,1919.885 " fill="none" id="SvSetting&lt;-LogRead" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="177.5893" cy="1846.6997" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174.5906" x2="180.588" y1="1854.1165" y2="1839.283"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="170.1726" x2="185.006" y1="1843.701" y2="1849.6984"/><!--MD5=[8d1c764bcc19989851e984ffe55e2961]
reverse link SvSetting to NegativeBalance--><path d="M265.647,1815 C272.331,1815 279.015,1815 285.7,1815 " fill="none" id="SvSetting&lt;-NegativeBalance" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="258.539" cy="1815" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="266.539" x2="250.539" y1="1815" y2="1815"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258.539" x2="258.539" y1="1823" y2="1807"/><!--MD5=[6dfdeae171dfd9cd22b34147dfd49ed3]
link N1 to PoSecuritySetting--><path d="M543.704,196.29 C550.079,213.54 557.603,233.89 565.66,255.68 " fill="none" id="N1-PoSecuritySetting" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[cbb2aad232e2dbd9b1cd15526f5fb356]
link PoRevokedService to PoSecuritySetting--><path d="M212.276,173.3 C233.036,190.26 261.21,209.96 290,220 C329.111,233.64 439.982,211.55 476,232 C484.255,236.69 492.205,241.94 499.853,247.67 " fill="none" id="PoRevokedService-&gt;PoSecuritySetting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="510.094,255.75,507.8646,248.8922,500.6768,248.3125,502.9062,255.1703,510.094,255.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="194.5224" y="194.3358">0..1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="498.3557" y="245.3828">1</text><!--MD5=[5d6d67a6e099206d95b683be9999b9cd]
reverse link PoSecuritySetting to SamRevokedService--><path d="M813.348,245.9 C817.535,241.17 821.754,236.53 826,232 C846.492,210.14 872.602,189.21 894.561,173.15 " fill="none" id="PoSecuritySetting&lt;-SamRevokedService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="804.801,255.74,811.756,253.8353,812.6729,246.6827,805.7178,248.5874,804.801,255.74" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="802.7328" y="245.3725">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="861.6464" y="194.4035">0..1</text><!--MD5=[e4e6b0c197a4fe408c8d4c7214bc9356]
link PoResource to PoTransaction--><path d="M439.496,896.59 C452.623,919.24 470.871,950.73 491.707,986.68 " fill="none" id="PoResource-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="498.254,997.98,498.7082,990.7832,492.2396,987.596,491.7855,994.7928,498.254,997.98" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="435.4766" y="917.7751">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="486.3498" y="986.9461">1</text><!--MD5=[7ef23bb65cbd7f21990abf12f0f9fb41]
link PoSecuritySetting to PoTransaction--><path d="M665.133,719.03 C670.136,800.64 675.898,894.61 681.426,984.78 " fill="none" id="PoSecuritySetting-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="682.222,997.77,685.8452,991.5352,681.4836,985.7927,677.8604,992.0275,682.222,997.77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="643.2358" y="740.3892">0..1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="674.6295" y="986.7311">1</text><!--MD5=[4e36a4e3a201b7955d2f14bdee0043a9]
reverse link PoTransaction to SessionState--><path d="M719.324,1725.198 C720.015,1741.887 720.639,1756.96 721.168,1769.751 " fill="none" id="PoTransaction&lt;-SessionState" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="719.0307" cy="1718.1262" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="719.3613" x2="718.7" y1="1726.1193" y2="1710.133"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="711.0375" x2="727.0238" y1="1718.4568" y2="1717.7955"/><!--MD5=[ce3c63ddc54d4d675759c68b3655a59d]
reverse link PoTransaction to SessionSetting--><path d="M859.969,1724.019 C871.636,1751.622 881.468,1774.886 888.211,1790.84 " fill="none" id="PoTransaction&lt;-SessionSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="857.2148" cy="1717.5017" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="860.3296" x2="854.1" y1="1724.8704" y2="1710.133"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="849.8461" x2="864.5835" y1="1720.6165" y2="1714.3869"/><!--MD5=[01907a979ee07ab82f1dc532a4541c2c]
reverse link SessionSetting to EncryptionMode--><path d="M899.364,1854.468 C900.086,1874.832 900.969,1899.726 901.684,1919.885 " fill="none" id="SessionSetting&lt;-EncryptionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="899.1094" cy="1847.278" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="899.3929" x2="898.826" y1="1855.273" y2="1839.283"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="891.1145" x2="907.1044" y1="1847.5614" y2="1846.9945"/><!--MD5=[19a5bab6cb0e733f5b38e95cd959a25a]
reverse link SessionSetting to ModificationMode--><path d="M837.214,1845.533 C825.946,1850.612 814.198,1855.649 803,1860 C720.851,1891.916 696.579,1889.214 614,1920 C608.517,1922.044 602.876,1924.245 597.229,1926.518 " fill="none" id="SessionSetting&lt;-ModificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="843.8834" cy="1842.4677" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="836.6148" x2="851.152" y1="1845.8095" y2="1839.126"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="840.5416" x2="847.2251" y1="1835.1991" y2="1849.7364"/><!--MD5=[0e9a2e2ec4d6aea28d869b2d373dbe85]
reverse link SessionSetting to RatificationMode--><path d="M852.855,1847.987 C822.699,1869.354 782.932,1897.531 751.382,1919.885 " fill="none" id="SessionSetting&lt;-RatificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="858.6114" cy="1843.908" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="852.0838" x2="865.139" y1="1848.533" y2="1839.283"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="853.9864" x2="863.2364" y1="1837.3804" y2="1850.4356"/><!--MD5=[d0f8f68742f1a8058f4f2e5a0ad06650]
reverse link SessionSetting to AccessLevel--><path d="M936.737,1849.706 C955.153,1868.334 975.24,1893.121 985,1920 C1000.169,1961.776 1003.094,1979.406 985,2020 C979.079,2033.283 969.742,2045.284 959.299,2055.71 " fill="none" id="SessionSetting&lt;-AccessLevel" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="931.6368" cy="1844.7724" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="937.3866" x2="925.887" y1="1850.3347" y2="1839.21"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="926.0744" x2="937.1992" y1="1850.5222" y2="1839.0226"/><!--MD5=[37e957bec1fd56bfe0d2d70b2ed06b69]
link EncryptionMode to AccessLevel--><!--MD5=[aad50e08903197c6896398c3f9217d50]
reverse link SessionSetting to AuthenticationMode--><path d="M868.027,1850.622 C852.248,1870.072 833.441,1895.335 820,1920 C797.325,1961.612 811.529,1982.16 783,2020 C770.635,2036.4 753.989,2050.936 737.433,2062.965 " fill="none" id="SessionSetting&lt;-AuthenticationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="872.5252" cy="1845.1925" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="867.4215" x2="877.629" y1="1851.353" y2="1839.032"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="866.3647" x2="878.6857" y1="1840.0887" y2="1850.2963"/><!--MD5=[6952bc2877cf5d205c9a3c02c8dd195c]
link ModificationMode to AuthenticationMode--><!--MD5=[079f273270ef1dd73893779fe3d467bc]
reverse link PoTransaction to PinTransmissionMode--><path d="M572.786,1724.492 C565.605,1744.714 559.257,1762.588 554.16,1776.943 " fill="none" id="PoTransaction&lt;-PinTransmissionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="575.2078" cy="1717.6717" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="572.5306" x2="577.885" y1="1725.2105" y2="1710.133"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567.669" x2="582.7465" y1="1714.9945" y2="1720.349"/><!--MD5=[746f3c5b2505d7b38384202071141ba9]
reverse link PoTransaction to SvSetting--><path d="M310.391,1706.491 C270.848,1741.803 237.388,1771.682 215.857,1790.91 " fill="none" id="PoTransaction&lt;-SvSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="315.7329" cy="1701.7206" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="309.7659" x2="321.7" y1="1707.0492" y2="1696.392"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="310.4043" x2="321.0615" y1="1695.7535" y2="1707.6877"/><!--MD5=[28e38a2b5aeddf77f446bb48690e6362]
link SessionState to SessionSetting--><!--MD5=[bc4e75526f74fbb68a5aed8e4c56686a]
link SessionSetting to PinTransmissionMode--><!--MD5=[15b34b46d09c17d92f3246bd8d6b690e]
link PinTransmissionMode to SvSetting--><!--MD5=[3429ec821e60fb1fffd23386c89f33c5]
link PoTransaction to SelectFileControl--><path d="M973.629,1710.223 C980.322,1724.392 986.485,1738.673 992,1753 C1058.79,1926.503 1110.42,2004.871 1025,2170 C1015.12,2189.108 998.331,2204.633 980.679,2216.746 " fill="none" id="PoTransaction-SelectFileControl" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[30641f45b0628209a5479aad6dfa6f2f]
link PoTransaction to ChannelControl--><path d="M998.104,1710.17 C1006.55,1724.381 1014.55,1738.681 1022,1753 C1102.71,1908.125 1092.99,2126.501 1085.13,2212.812 " fill="none" id="PoTransaction-ChannelControl" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[75cf09f748786ce5d6dd001ad977eb2a]
link AuthenticationMode to SelectFileControl--><!--MD5=[816c1fefc9463d481f66103582bcea7c]
link SelectFileControl to ChannelControl--><!--MD5=[c19a3c143300106d783cee8a829b85d7]
@startuml
skinparam stereotypeIBorderColor BUSINESS
skinparam stereotypeCBorderColor BUSINESS
skinparam stereotypeEBorderColor BUSINESS
skinparam shadowing false

together {
  together {

    together {
      +interface PoRevokedService {
        +isPoRevoked(byte[] 8bytesSerial)
      }

      note as N1
      Default values in PoTransaction if PoSecuritySetting doesn't specify it:
        - session ModificationMode as ATOMIC
        - session RatificationMode as CLOSE_RATIFIED
        - PinTransmissionMode as ENCRYPTED if PoSecurity defined
        - any KIF/KVC values are authorized
        - no verification is done for: HCE token expiration, revoked PO or SAM
      end note

      +interface SamRevokedService {
        +isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)
      }

      PoRevokedService -right[hidden]- N1
      SamRevokedService -left[hidden]- N1
    }

    together {
      +interface PoHceService {
        +boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)
      }

      +class "<b>final</b> PoSecuritySetting" as PoSecuritySetting {
        +PoSecuritySetting(SamResource samResource);
        +setPoRevokedService(PoRevokedService revokedPo)
        +setSamRevokedService(SamRevokedService revokedSam)
        +setPoHceService(PoHceService expiredHce)
        #PoRevokedService getPoRevokedService()
        #SamRevokedService getSamRevokedService()
        #PoHceService getPoHceService()

        +loadProperties(Properties propertyFile)

        +setSessionModificationMode(ModificationMode mode)
        +setSessionRatificationMode(RatificationMode mode)
        +setSessionDefaultKif(AccessLevel level, byte kif)
        +setSessionDefaultKvc(AccessLevel level, byte kvc)
        +setSessionAuthorizedKvcList(byte[] kvc)
        #ModificationMode getSessionModificationMode()
        #RatificationMode getSessionRatificationMode()
        #Byte getSessionDefaultKif(AccessLevel level)
        #Byte getSessionDefaultKvc(AccessLevel level)
        #Boolean isSessionKvcAuthorized(byte kvc)

        +setPinTransmissionMode(PinTransmissionMode mode)
        #PinTransmissionMode getPinTransmissionMode()

        +setSvGetLogReadMode(LogRead readRule)
        +setSvNegativeBalanceMode(NegativeBalance authorization)
        +setSvAuthorizedKvcList(byte[] kvc)
        #LogRead getSvGetLogReadMode()
        #NegativeBalance getSvNegativeBalance()
        #Boolean isSvKvcAuthorized(byte kvc)
      }

      +class "SeResource<CalypsoSam>" as SamResource {
        +SeResource(<color:red>SeReader seReader</color>,
        CalypsoSam sam);
      }

      PoHceService "0..1 " -right-o " 1" PoSecuritySetting
      PoSecuritySetting "1 " o-right- " 0..1" SamResource
    }

    +class "SeResource<CalypsoPo>" as PoResource {
      +SeResource(<color:red>SeReader seReader</color>,
      CalypsoPo po);
    }


    PoRevokedService -down[hidden]- PoHceService
    PoHceService -down[hidden]- PoResource

    +class "<b>final</b> CalypsoSam" as CalypsoSam {
      ~CalypsoSam(<color:red>SeResponse selectionResponse</color>)

      +SamRevision getSamRevision()
      +byte[] getSerialNumber()
      +byte getPlatform()
      +byte getApplicationType()
      +byte getApplicationSubType()
      +byte getSoftwareIssuer()
    }

    SamRevokedService -down[hidden]- SamResource
    SamResource "1" o-down- "1" CalypsoSam

    +class PoTransaction {
      +PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)

      +<b>final</b> processPoCommands(ChannelControl channel)
      +<b>final</b> processOpening(AccessLevel level)
      +<b>final</b> processPoCommandsInSession()
      +<b>final</b> processClosing(ChannelControl channel)
      +<b>final</b> processCancel(ChannelControl channel)
      +<b>final</b> prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)
      +<b>final</b> SessionSecureData getSessionSecureData()

      +<b>final</b> prepareCheckPinStatus()
      +<b>final</b> prepareVerifyPin(String pin)
      +<b>final</b> prepareVerifyPin(byte[] pin)

      +<b>final</b> prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)
      +<b>final</b> prepareSvReload(int amount, int date, int time, String free)
      +<b>final</b> prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)
      +<b>final</b> prepareSvReload(int amount)
      +<b>final</b> prepareSvDebit(int amount, int date, int time)
      +<b>final</b> prepareSvDebit(int amount, byte[] date, byte[] time)
      +<b>final</b> prepareSvDebit(int amount)
      +<b>final</b> SvOperationSecureData getSvOperationSecureData()

      +<b>final</b> prepareSelectFile(short lid)
      +<b>final</b> prepareSelectFile(byte[] lid)
      +<b>final</b> prepareSelectFile(SelectFileControl control)
      +<b>final</b> prepareReadRecordFile(byte sfi, int recordNumber)
      +<b>final</b> prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))
      +<b>final</b> prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)
      +<b>final</b> prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)
      +<b>final</b> prepareReadCounterFile(byte sfi, int countersNumber)
      +<b>final</b> prepareAppendRecord(byte sfi, byte[] recordData)
      +<b>final</b> prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)
      +<b>final</b> prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)
      +<b>final</b> prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
      +<b>final</b> prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
      +<b>final</b> prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)
      +<b>final</b> prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)
      +<b>final</b> prepareSetCounter(byte sfi, int counterNumber, int newValue)
      +<b>final</b> int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)
      +<b>final</b> int[] getSearchResult(int searchRequestNumber)

      +<b>final</b> prepareInvalidate()
      +<b>final</b> prepareRehabilitate()

      +<b>final</b> prepareChangeKey(AccessLevel level)
      +<b>final</b> prepareChangePin(String pin)
      +<b>final</b> prepareChangePin(byte[] pin)
    }

    -enum SessionState {
      SESSION_UNITIALIZED,
      SESSION_OPEN,
      SESSION_CLOSED
    }

    +class "<b>final</b> SessionSetting" as SessionSetting {
    }

    +enum AccessLevel {
      SESSION_LVL_PERSO("perso", byte 0x01),
      SESSION_LVL_LOAD("load", byte 0x02),
      SESSION_LVL_DEBIT("debit", byte 0x03)
    }

    +enum ModificationMode {
      ATOMIC,
      MULTIPLE
    }

    +enum RatificationMode {
      CLOSE_RATIFIED,
      CLOSE_NOT_RATIFIED
    }

    +enum EncryptionMode {
      ACTIVATE,
      DEACTIVATE
    }

    +enum AuthenticationMode {
      REQUESTED,
      NOT_REQUESTED
    }

    +enum PinTransmissionMode {
      PLAIN,
      ENCRYPTED
    }

    together {
      +class "<b>final</b> SvSetting" as SvSetting {
      }

      +enum Operation {
        RELOAD,
        DEBIT
      }

      +enum Action {
        DO,
        UNDO
      }

      +enum LogRead {
        SINGLE,
        ALL
      }

      +enum NegativeBalance {
        FORBIDDEN,
        AUTHORIZED
      }

      SvSetting +-down- Operation
      SvSetting +-down- Action
      SvSetting +-down- LogRead
      SvSetting +-right- NegativeBalance
    }

    PoSecuritySetting .up. N1
    PoRevokedService "0..1" - -o "1" PoSecuritySetting
    PoSecuritySetting "1" o- - "0..1" SamRevokedService

    PoResource "1" - -o "1" PoTransaction
    PoTransaction "1" o-up- "0..1" PoSecuritySetting

    PoTransaction +-down- SessionState

    PoTransaction +-down- SessionSetting
    SessionSetting +-down- EncryptionMode
    SessionSetting +-down- ModificationMode
    SessionSetting +-down- RatificationMode
    SessionSetting +- - AccessLevel
    EncryptionMode -down[hidden]- AccessLevel
    SessionSetting +- - AuthenticationMode
    ModificationMode -down[hidden]- AuthenticationMode

     PoTransaction +-down- PinTransmissionMode

    PoTransaction +-down- SvSetting

    SessionState -right[hidden]- SessionSetting
    SessionSetting -right[hidden]- PinTransmissionMode
    PinTransmissionMode -right[hidden]- SvSetting
  }

  +enum SelectFileControl {
    FIRST_EF,
    NEXT_EF,
    CURRENT_DF
  }

  +enum ChannelControl {
	KEEP_OPEN
	CLOSE_AFTER
  }

  PoTransaction - - SelectFileControl
  PoTransaction - - ChannelControl
  AuthenticationMode -down[hidden]- SelectFileControl
  ChannelControl -left[hidden]- SelectFileControl
}
@enduml

PlantUML version 1.2020.09(Sun May 10 14:51:06 MUT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+8-b765.40
Operating System: Windows 10
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>